version: '3.8'

services:
  botcoin:
    image: ghcr.io/projectbotchain/botcoin:v1.0.0
    container_name: botcoin
    restart: unless-stopped
    
    # CPU limits (~50% by default)
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 2G
    
    volumes:
      - botcoin-data:/home/botcoin/.botcoin
    
    # Expose P2P port (RPC stays internal for security)
    ports:
      - "8433:8433"  # P2P
      # Uncomment to expose RPC (NOT recommended for production):
      # - "127.0.0.1:8432:8432"
    
    # Health check
    healthcheck:
      test: ["CMD", "botcoin-cli", "getblockchaininfo"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

volumes:
  botcoin-data:
    driver: local

# Usage:
# ------
# Start:
#   docker-compose up -d
#
# Check status:
#   docker-compose exec botcoin botcoin-cli getblockchaininfo
#
# Create wallet:
#   docker-compose exec botcoin botcoin-cli createwallet "miner"
#
# Get address:
#   docker-compose exec botcoin botcoin-cli -rpcwallet=miner getnewaddress
#
# Mine a block:
#   docker-compose exec botcoin botcoin-cli -rpcwallet=miner generatetoaddress 1 "YOUR_ADDRESS"
#
# View logs:
#   docker-compose logs -f botcoin
#
# Stop:
#   docker-compose down
#
# Stop and remove data:
#   docker-compose down -v
